namespace SpriteKind {
    export const bonus = SpriteKind.create()
}
sprites.onOverlap(SpriteKind.Player, SpriteKind.bonus, function (sprite, otherSprite) {
    chest.setImage(img`
        . b b b b b b b b b b b b b b . 
        b e 4 4 4 4 4 4 4 4 4 4 4 4 4 b 
        b e 4 4 4 4 4 4 4 4 4 4 4 4 e b 
        b e e 4 4 4 4 4 4 4 4 4 4 e e b 
        b b b b b b b d d b b b b b b b 
        . b b b b b b c c b b b b b b . 
        b c c c c c b c c b c c c c c b 
        b c c c c c c b b c c c c c c b 
        b c c c c c c c c c c c c c c b 
        b c c c c c c c c c c c c c c b 
        b b b b b b b b b b b b b b b b 
        b e e e e e e e e e e e e e e b 
        b e e e e e e e e e e e e e e b 
        b c e e e e e e e e e e e e c b 
        b b b b b b b b b b b b b b b b 
        . b b . . . . . . . . . . b b . 
        `)
    pause(500)
    otherSprite.destroy(effects.spray, 500)
    for (let value of wall) {
        tiles.setTileAt(value, myTiles.transparency16)
        tiles.setWallAt(value, false)
    }
})
controller.A.onEvent(ControllerButtonEvent.Pressed, function () {
    if (motherbib.vy == 0) {
        motherbib.vy = -150
    }
})
sprites.onOverlap(SpriteKind.Player, SpriteKind.Enemy, function (sprite, otherSprite) {
    if (sprite.y < otherSprite.top) {
        otherSprite.destroy(effects.fire, 100)
        chest = sprites.create(img`
            . . b b b b b b b b b b b b . . 
            . b e 4 4 4 4 4 4 4 4 4 4 e b . 
            b e 4 4 4 4 4 4 4 4 4 4 4 4 e b 
            b e 4 4 4 4 4 4 4 4 4 4 4 4 e b 
            b e 4 4 4 4 4 4 4 4 4 4 4 4 e b 
            b e e 4 4 4 4 4 4 4 4 4 4 e e b 
            b e e e e e e e e e e e e e e b 
            b e e e e e e e e e e e e e e b 
            b b b b b b b d d b b b b b b b 
            c b b b b b b c c b b b b b b c 
            c c c c c c b c c b c c c c c c 
            b e e e e e c b b c e e e e e b 
            b e e e e e e e e e e e e e e b 
            b c e e e e e e e e e e e e c b 
            b b b b b b b b b b b b b b b b 
            . b b . . . . . . . . . . b b . 
            `, SpriteKind.bonus)
        tiles.placeOnTile(chest, tiles.getTileLocation(1, 0))
    } else {
        game.over(false, effects.melt)
    }
})
let chest: Sprite = null
let motherbib: Sprite = null
let wall: tiles.Location[] = []
tiles.setTilemap(tiles.createTilemap(hex`6400100000000000000000000000000000000000000000000000000000000000000000060000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007070000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000707000000000000000000000000060000000000000000000000000000000000000000000000000000000000000000000000000000000000000100010000010100000000000000000000000000000000000000000000000000000000000000000000000000070707000000000000000000000600000000000000000000000000000000000000000000000000000000000000000101010100000000000001000101010101000000000000000000000000000000000000000000000000000000000000000000000000000000070707000000000000000006000000000000000000000000000000000000000000000000000000000000010101010001010100000001000000010101010101010100000000000000000000000000000000000000000000000000000000000000000000000000070700010001000000060101010000000001010100000000010000010001010101010101010101010101000000000001010101010000000101000001010101000000000000000000000000000000000000000000000000000000000000000000000000000000000100010000000103030301010000010301000000000001010300000000000000000000000000000000000000000000000000000000000000010100010101000000000000000000000000000200000000000000000000000001010000010100000101000101030101010103030303030301010103010101010101000303000000000000000000000000000000000000000000000000000000000000010100000000000000000000000001010101000001010101010400000000000501010303030303030303030303030303030303030303030303030303030303030303030303030000000000000000000000000000000000000000000000000000000101010100000000000000000100000101010001010101030303030301010101010101030303030303030303030303030303030303030303030303030303030303030303030303030300000000000000000000000000000000000000000000000000000001010000000000000000000001010101000000000101000303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303000000000000000000000000000000000000000000000000000000010101010101010101000001010101000000000000000003030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030000000000000000000000000000000000000000000000000000000101010101010101010001010000000000000000000000030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030300000000000000000000000000000000000000000000000000000001010101010101010101010000000000000000000000000303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303000000000000000000000000000000000000000000000000000000000001010101010100000000000000000000000000000003030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000`, img`
    ...............................2....................................................................
    ...............................2....................................................................
    ................22.............2...........................................2........................
    .................22............2..........................................2.2..22...................
    ..................222..........2.................................222......2.22.22...................
    ....................222........2..............................2222.222...2...22222..................
    ......................22.2.2...2222....222....2..22222222222222......22222...22..2.22...............
    .........................2.2...2...22..2.2.....22................................2..222.............
    .............22..22..22.22.2222......222.222222................................222...........2222...
    22222.......22...............................................................22..........2.222..2222
    .....2222222.................................................................22..........222........
    .............................................................................222222222..222.........
    .............................................................................222222222222...........
    .............................................................................22.2222222.............
    ..............................................................................2222222...............
    ..................................................................................22................
    `, [myTiles.transparency16,sprites.builtin.oceanDepths0,myTiles.tile1,sprites.dungeon.hazardLava0,sprites.builtin.coral1,sprites.builtin.coral4,sprites.builtin.oceanDepths1,sprites.builtin.forestTiles0,sprites.dungeon.chestClosed,myTiles.tile2], TileScale.Sixteen))
wall = tiles.getTilesByType(sprites.builtin.forestTiles0)
motherbib = sprites.create(img`
    . . . . . . . . . . . . . . . . 
    . . . . . f f f f f f . . . . . 
    . . . f f e e e e f 2 f . . . . 
    . . f f e e e e f 2 2 2 f . . . 
    . . f e e e f f e e e e f . . . 
    . . f f f f e e 2 2 2 2 e f . . 
    . . f e 2 2 2 f f f f e 2 f . . 
    . f f f f f f f e e e f f f . . 
    . f f e 4 4 e b f 4 4 e e f . . 
    . f e e 4 d 4 1 f d d e f f . . 
    . . f e e e 4 d d d d f d d f . 
    . . . . f e e 4 e e e f b b f . 
    . . . . f 2 2 2 4 d d e b b f . 
    . . . f f 4 4 4 e d d e b f . . 
    . . . f f f f f f e e f f . . . 
    . . . . f f . . . f f f . . . . 
    `, SpriteKind.Player)
tiles.placeOnRandomTile(motherbib, myTiles.tile1)
controller.moveSprite(motherbib, 100, 0)
motherbib.ay = 300
scene.cameraFollowSprite(motherbib)
let shark = sprites.create(img`
    ........................
    ........................
    ........................
    ........................
    ........................
    ..........ffff..........
    ........ff1111ff........
    .......fb111111bf.......
    .......f11111111f.......
    ......fd11111111df......
    ....7.fd11111111df......
    ...7..fd11111111df......
    ...7..fd11111111df......
    ...7..fddd1111dddff.....
    ...77.fbdbfddfbdbfcf....
    ...777fcdcf11fcdcfbf....
    ....77fffbdb1bdffcf.....
    ....fcb1bcffffff........
    ....f1c1c1ffffff........
    ....fdfdfdfffff.........
    .....f.f.f..............
    ........................
    ........................
    ........................
    `, SpriteKind.Player)
tiles.placeOnRandomTile(shark, sprites.builtin.coral1)
shark.x += 14
game.onUpdate(function () {
    if (motherbib.y > 200) {
        game.over(false, effects.clouds)
    }
    if (shark.tileKindAt(TileDirection.Left, sprites.builtin.coral1)) {
        shark.vx = 50
        shark.setImage(img`
            ........................
            ........................
            ........................
            ..........ffff..........
            ........ff1111ff........
            .......fb111111bf.......
            ......fbd1111111f.......
            ......fdd1111111df......
            ......fddd111111df......
            ......fdddddd111df......
            ......fdddddd111df......
            ......fbddddddd1df......
            ......ffbbddbfd1df......
            .......fcbbdcfddbf......
            .......fffbddccffff.....
            .......ffffcfbbb1bcf....
            ......ffffffffcd1b1f....
            ...ffffffffff..fdfdf....
            .....ffffff.....f.f.....
            ........................
            ........................
            ........................
            ........................
            ........................
            `)
    } else if (shark.tileKindAt(TileDirection.Right, sprites.builtin.coral4)) {
        shark.vx = -50
        shark.setImage(img`
            ........................
            ........................
            ........................
            ........................
            .........fffff..........
            ........f11111ff........
            .......fb111111bf.......
            .......f1111111dbf......
            ......fd111111dddf......
            ......fd11111ddddf......
            ......fd11dddddddf......
            ......f111dddddddf......
            ......f11fcddddddf......
            .....fb1111bdddbf.......
            .....f1b1bdfcfff........
            .....fbfbffffffff.......
            ......fffffffffff.ff....
            ...........ffffffff.....
            ........f1b1bffffff.....
            ........fbfbffffff......
            ........................
            ........................
            ........................
            ........................
            `)
    }
    if (controller.left.isPressed()) {
        motherbib.setImage(img`
            . . . . . . . . . . . . . . . . 
            . . . . . f f f f f f . . . . . 
            . . . . f 2 f e e e e f f . . . 
            . . . f 2 2 2 f e e e e f f . . 
            . . . f e e e e f f e e e f . . 
            . . f e 2 2 2 2 e e f f f f . . 
            . . f 2 e f f f f 2 2 2 e f . . 
            . . f f f e e e f f f f f f f . 
            . . f e e 4 4 f b e 4 4 e f f . 
            . . . f e d d f 1 4 d 4 e e f . 
            . . . . f d d d e e e e e f . . 
            . . . . f e 4 e d d 4 f . . . . 
            . . . . f 2 2 e d d e f . . . . 
            . . . f f 5 5 f e e f f f . . . 
            . . . f f f f f f f f f f . . . 
            . . . . f f f . . . f f . . . . 
            `)
    } else if (controller.right.isPressed()) {
        motherbib.setImage(img`
            . . . . . . . . . . . . . . . . 
            . . . . . . f f f f f f . . . . 
            . . . . f f e e e e f 2 f . . . 
            . . . f f e e e e f 2 2 2 f . . 
            . . . f e e e f f e e e e f . . 
            . . . f f f f e e 2 2 2 2 e f . 
            . . . f e 2 2 2 f f f f e 2 f . 
            . . f f f f f f f e e e f f f . 
            . . f f e 4 4 e b f 4 4 e e f . 
            . . f e e 4 d 4 1 f d d e f . . 
            . . . f e e e 4 d d d d f . . . 
            . . . . 4 d d e 4 4 4 e f . . . 
            . . . . e d d e 2 2 2 2 f . . . 
            . . . . f e e f 4 4 5 5 f f . . 
            . . . . f f f f f f f f f f . . 
            . . . . . f f . . . f f f . . . 
            `)
    }
})
game.onUpdate(function () {
    if (motherbib.y > 200) {
        game.over(false)
    }
})
